#
# Copyright (C) 2017-2019 Dremio Corporation. This file is confidential and private property.
#

suite: Dremio EE Helm Chart.License Tests
templates:
  - dremio-trial-image-pull-credentials-secret.yaml
tests:
  - it: should not render by default
    set:
      distStorage:
        type: gcp
        gcp:
          bucketName: test-bucket
          authentication: auto
          credentials:
            clientEmail: test@example.com
            privateKey: test-private-key
    asserts:
      - hasDocuments:
          count: 0
  - it: should create a secret that contains the trial image pull credentials
    set:
      distStorage:
        type: gcp
        gcp:
          bucketName: test-bucket
          authentication: auto
          credentials:
            clientEmail: test@example.com
            privateKey: test-private-key
      dremio:
        trialImagePullCredentials: test-image-pull-credentials
    asserts:
      - equal:
          path: data[".dockerconfigjson"]
          value: test-image-pull-credentials
